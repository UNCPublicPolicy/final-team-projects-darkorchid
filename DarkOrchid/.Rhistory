View(my_data)
my_data %>% dplyr::select(my_x:y_obs)%>%
ggcorr()
?ggcorr
??ggcorr
library(GGally)
my_data %>% dplyr::select(my_x:y_obs)%>%
ggcorr()
ggplot(data_clean, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=2)+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=2)+
theme_minimal()
my_model <- lm(y_obs ~ my_x, data = my_data)
summary(my_model)
coefficients(my_model)
coefficients(my_model$my_x)
coefficients(my_data$my_x)
subset(my_data)
summary(my_model)
library(moderndive)
install.packages("moderndrive")
library(moderndive)
install.packages("moderndrive")
install.packages("moderndive")
library(moderndive)
my_model %>% get_regression_points()
regression_points <- my_model %>% get_regression_points()
regression_points
my_data <- my_data %>%
mutate(y_pred = predict(my_model))
my_data
my_data <- my_data %>%
mutate(x_pred = predict(my_model))
my_data
ggplot(data = my_data) +
geom_line(aes(my_x, y_pred),
lwd = 1,
color = "black") +
geom_point(aes(my_x, y_obs),
shape=21,
fill="orange",
color="black",
alpha = 0.7,
size=4)+
labs(y = "y", my_x = "x") +
theme_bw()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=3)+
geom_smooth(method=lm, size=.5, se= FALSE)
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=3)+
geom_smooth(method=lm, size=.5, se= FALSE)+
theme_minimal()
ggplot(my_data) +
geom_errorbar(data=my_data, aes(x = my_x,
ymin = y_obs,
ymax = y_obs - pred_error),
width=0,
lwd = 1,
color = "darkorange",
lty = "dashed",
inherit.aes = FALSE)+
geom_line(aes(my_x, y_pred),
lwd = 1,
color = "black") +
geom_point(aes(my_x, y_obs),
shape=21,
fill="orange",
color="black",
alpha = 0.7,
size=4)+
labs(y = "y", x = "x") +
theme_bw()
seq(x_min, x_max, x_steps))
seq(x_min, x_max, x_steps)
a        <- -2 #negative relationship
b        <- 0.5
# error term
e_mean   <- 0
e_sd     <- 4
# x observations
# the smaller the x_steps, the more x values you get.
x_min    <- 2
x_max    <- 10
x_steps  <- 0.5
# Create a data frame with the model data
my_data <- data.frame(my_x = seq(x_min, x_max, x_steps)) %>%
dplyr::mutate(y_pop  = b + a * my_x,
e      = rnorm(n(), e_mean, e_sd),
y_obs = y_pop + e)
my_data
a        <- -2 #negative relationship
b        <- 0.5
# error term
e_mean   <- 0
e_sd     <- 2
# x observations
# the smaller the x_steps, the more x values you get.
x_min    <- 2
x_max    <- 10
x_steps  <- 0.5
# Create a data frame with the model data
my_data <- data.frame(my_x = seq(x_min, x_max, x_steps)) %>%
dplyr::mutate(y_pop  = b + a * my_x,
e      = rnorm(n(), e_mean, e_sd),
y_obs = y_pop + e)
my_data
library(GGally)
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=2)+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(size=3)+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(size=2.5)+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(size=2.5, color=darkorchid)+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(size=2.5, color='darkorchid')+
theme_minimal()
ggplot(data = my_data) +
geom_line(aes(my_x, y_pred),
lwd = 1,
color = "black") +
geom_point(aes(my_x, y_obs),
shape=21,
fill="orange",
color="black",
alpha = 0.7,
size=4)+
labs(y = "y", my_x = "x") +
theme_bw()
my_model <- lm(y_obs ~ my_x, data = my_data)
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=3)+
geom_smooth(method=lm, size=.5, se= FALSE)+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=3)+
geom_smooth(method=lm, size=.5, se= FALSE, color="darkorange")+
theme_minimal()
geom_point(alpha=.5, size=2, color='darkorchid)+
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=2, color='darkorchid')+
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=.5, size=2, color='darkorchid')+
geom_smooth(method=lm, size=.5, se= FALSE, color="darkorange")+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(alpha=2, size=2, color='darkorchid')+
geom_smooth(method=lm, size=.5, se= FALSE, color="darkorange")+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(size=2, color='darkorchid')+
geom_smooth(method=lm, size=.5, se= FALSE, color="darkorange")+
theme_minimal()
ggplot(my_data, aes(x=my_x, y=y_obs)) +
geom_point(size=2.5, color='darkorchid')+
geom_smooth(method=lm, size=.5, se= FALSE, color="darkorange")+
theme_minimal()
summary(my_model)
```{r}
coefficients(my_model)[1]
coefficients(my_model)
get_regression_table(my_model)
my_data <- my_data %>%
mutate(y_pred = predict(my_model))
library(gapminder)
#knitr::opts_chunk$set()
library(tidyverse)
library(ggplot2)
library(GGally)
library(skimr)
getwd()
data_clean <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Merged_and_Cleaned_Data_Darkorchid4.csv")
glimpse(data_clean)
data_clean$lung_cancer_per_100000 <- as.numeric(data_clean$lung_cancer_per_100000) # fix for this column being read in as character
View(data_clean)
data_clean %>% summarise_all(funs(sum(is.na(.))))
# In our data set, we only have 1 missing value, which is for Nevada in the lung cancer per 100,000 column. It is coded as "NA".
# There are some 0's in our data set, but these are actual 0 values and not necessarily missing data.
library(naniar)
vis_miss(data_clean) # based on this function, we have 99.8% of the data present, and are missing .2%, which is in the lung_cancer_per_100000 column.
#normally distributed
data_clean %>% ggplot(aes(x=chronic_lower_respiratory_disease_deaths_per_100_000_people))+
geom_density()+
theme_classic()
summary(data_clean)
#Histogram for state co2
ggplot(data_clean, aes(x=stateco2)) +
geom_histogram(alpha=1,show.legend = FALSE) +
labs(x="State CO2", y="Density") +
scale_fill_viridis_d() +
theme_minimal()
ggplot(data_clean, aes(x=stateco2, y=lung_cancer_per_100000)) +
geom_point(alpha=.5, size=2)+
labs(x="State CO2", y="Lung Cancer Instances Per 100,000")+
theme_minimal()
ggplot(data_clean, aes(x=stateco2, y=chronic_lower_respiratory_disease_deaths_per_100_000_people)) +
geom_line()+
theme_minimal()
data_clean %>% dplyr::select(chronic_lower_respiratory_disease_deaths_per_100_000_people:stateco2)%>%
ggcorr()
getwd()
getwd()
setwd("/Users/betsynorwood/Documents/GitHub/")
montana <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/montana_lung_cancer.csv")
montana <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/montana_lung_cancer.csv")
View(montana)
montana <- montana %>% rename_at('SitsinState', ~'State')
View(montana)
montana <- montana %>% rename_at('SitsinState', ~'State')
montana <- montana[-c(1), ]
montana <- montana[-c(1), ]
View(montana)
montana <- montana %>% rename_at('SitsinState', ~'State')
library(janitor)
#Clean names
library(janitor)
cleannames(montana)
#Clean names
library(janitor)
clean_names(montana)
View(montana)
#Clean names
library(janitor)
montana <- clean_names(montana)
View(montana)
montana <- montana %>% rename_at('SitsinState', ~'State')
montana <- montana %>% rename_at('GeoID_Name', ~'County')
View(montana)
montana <- montana %>% rename_at('sits_in_tate', ~'State')
#Unique
unique(montana)
#Unique
names(montana)
montana <- montana %>% rename_at('sits_in_state', ~'State')
montana <- montana %>% rename_at('geography_name', ~'County')
montana <- montana %>% rename_at('lung_bronchus_cancer_rate', ~'lung_cancer_per_100000')
names(montana)
unique(montana)
summary(montana)
montana <- as.numeric
montana
unique(montana)
names(montana)
View(montana)
getwd()
setwd("/Users/betsynorwood/Documents/GitHub/")
montana <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/montana_lung_cancer.csv")
View(montana)
montana <- montana[-c(1), ]
library(janitor)
montana <- clean_names(montana)
montana <- montana %>% rename_at('sits_in_state', ~'State')
montana <- montana %>% rename_at('geography_name', ~'County')
montana <- montana %>% rename_at('lung_bronchus_cancer_rate', ~'lung_cancer_per_100000')
unique(montana)
montana$lung_cancer_per_100000 <- as.numeric
montana$lung_cancer_per_100000 <- as.numeric
montana$lung_cancer_per_100000 <- as.numeric(c(1:56))
View(montana)
names(montana)
montana <- montana %>% select(-one_of('geography_type_description', 'data_time_period', 'geographic_vintage', 'data_source', 'selected_location'))
View(montana)
getwd()
setwd("/Users/betsynorwood/Documents/GitHub/")
montana <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/montana_lung_cancer.csv")
# View
View(montana)
# Deletes 1st row
montana <- montana[-c(1), ]
#Clean names
library(janitor)
montana <- clean_names(montana)
#Column names
names(montana)
#Removing columns
montana <- montana %>% select(-one_of('geography_type_description', 'data_time_period', 'geographic_vintage', 'data_source', 'selected_location'))
View(montana)
#Unique
unique(montana)
#Renaming
montana <- montana %>% rename_at('sits_in_state', ~'State')
montana <- montana %>% rename_at('geography_name', ~'County')
montana <- montana %>% rename_at('lung_bronchus_cancer_rate', ~'lung_cancer_per_100000')
wyoming <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/wyoming_lung_cancer.csv")
# View
View(montana)
View(wyoming)
# Deletes 1st row
montana <- montana[-c(1), ]
wyoming <- wyoming[-c(1), ]
#Clean names
library(janitor)
montana <- clean_names(montana)
wyoming <- clean_names(wyoming)
#Column names
names(montana)
names(wyoming)
wyoming <- wyoming %>% select(-one_of('geography_type_description', 'data_time_period', 'geographic_vintage', 'data_source', 'selected_location'))
#Unique
unique(montana)
unique(wyoming)
montana <- montana %>% rename_at('sits_in_state', ~'state')
montana <- montana %>% rename_at('geography_name', ~'county')
montana <- montana %>% rename_at('lung_bronchus_cancer_rate', ~'lung_cancer_per_100000')
wyoming <- wyoming %>% rename_at('sits_in_state', ~'state')
wyoming <- wyoming %>% rename_at('geography_name', ~'county')
wyoming <- wyoming %>% rename_at('lung_bronchus_cancer_rate', ~'lung_cancer_per_100000')
View(montana)
View(wyoming)
temp_mt <- montana
temp_mt %>% mutate_if(is.character,as.numeric)
temp_mt
temp_mt$lung_cancer_per_100000 <- as.numeric(temp_mt$lung_cancer_per_100000)
temp_mt
temp_mt$geo_id <- as.numeric(temp_mt$geo_id)
View(temp_mt)
temp_mt <- montana
temp_mt <- montana
View(temp_mt)
unique(temp_mt)
unique(temp_mt)
temp_mt$lung_cancer_per_100000 <- as.numeric(temp_mt$lung_cancer_per_100000)
temp_mt$geo_id <- as.numeric(temp_mt$geo_id)
unique(temp_mt)
summary(temp_mt)
montana$lung_cancer_per_100000 <- as.numeric(montana$lung_cancer_per_100000)
montana$geo_id <- as.numeric(montana$geo_id)
wyoming$lung_cancer_per_100000 <- as.numeric(wyoming$lung_cancer_per_100000)
wyoming$geo_id <- as.numeric(wyoming$geo_id)
unique(montana)
unique(wyoming)
names(wyoming)
montana <- montana %>% select(-one_of('geography_type_description', 'data_time_period', 'geographic_vintage', 'data_source', 'selected_location', 'formatted_geo_id'))
wyoming <- wyoming %>% select(-one_of('geography_type_description', 'data_time_period', 'geographic_vintage', 'data_source', 'selected_location', 'formatted_geo_id'))
montana <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/montana_lung_cancer.csv")
wyoming <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/wyoming_lung_cancer.csv")
idaho <- read_csv("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/idaho_lung_cancer.csv")
montana <- montana[-c(1), ]
wyoming <- wyoming[-c(1), ]
idaho <- idaho[-c(1), ]
montana <- clean_names(montana)
wyoming <- clean_names(wyoming)
idaho <- clean_names(idaho)
names(montana)
names(wyoming)
names(idaho)
montana <- montana %>% select(-one_of('geography_type_description', 'data_time_period', 'geographic_vintage', 'data_source', 'selected_location', 'formatted_geo_id'))
wyoming <- wyoming %>% select(-one_of('geography_type_description', 'data_time_period', 'geographic_vintage', 'data_source', 'selected_location', 'formatted_geo_id'))
idaho <- idaho %>% select(-one_of('geography_type_description', 'data_time_period', 'geographic_vintage', 'data_source', 'selected_location', 'formatted_geo_id'))
montana <- montana %>% rename_at('sits_in_state', ~'state')
montana <- montana %>% rename_at('geography_name', ~'county')
montana <- montana %>% rename_at('lung_bronchus_cancer_rate', ~'lung_cancer_per_100000')
wyoming <- wyoming %>% rename_at('sits_in_state', ~'state')
wyoming <- wyoming %>% rename_at('geography_name', ~'county')
wyoming <- wyoming %>% rename_at('lung_bronchus_cancer_rate', ~'lung_cancer_per_100000')
idaho <- idaho %>% rename_at('sits_in_state', ~'state')
idaho <- idaho %>% rename_at('geography_name', ~'county')
idaho <- idaho %>% rename_at('lung_bronchus_cancer_rate', ~'lung_cancer_per_100000')
montana$lung_cancer_per_100000 <- as.numeric(montana$lung_cancer_per_100000)
montana$geo_id <- as.numeric(montana$geo_id)
wyoming$lung_cancer_per_100000 <- as.numeric(wyoming$lung_cancer_per_100000)
wyoming$geo_id <- as.numeric(wyoming$geo_id)
idaho$lung_cancer_per_100000 <- as.numeric(idaho$lung_cancer_per_100000)
idaho$geo_id <- as.numeric(idaho$geo_id)
View(montana)
View(wyoming)
View(idaho)
write.csv(wyoming_clean.csv, "/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood)
write.csv(wyoming_clean.csv, "/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood")
write.csv(wyoming_clean.csv, "/Users/betsynorwood/Desktop")
write.csv(wyoming_clean.csv, "/Users/betsynorwood/Desktop/wyoming_clean.csv")
write.csv(wyoming, "/Users/betsynorwood/Desktop/wyoming_clean.csv")
write.csv(wyoming, "/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/wyoming_clean.csv")
write.csv(montana, "/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/montana_clean.csv")
write.csv(idaho, "/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/Norwood/idaho_clean.csv")
View(idaho)
setwd("/Users/betsynorwood/Documents/GitHub/final-team-projects-darkorchid/DarkOrchid/")
data <- read_csv("Cleaned Merged Data/darkorchid4_data.csv")
getwd()
getwd()
View(data)
names(data)
View(data)
clean_names(data)
View(data)
data <- clean_names(data)
names(data)
data %>% dplyr::select(county:both_other_chronic_respiratory_diseases)%>%
ggcorr()
data %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr()
data %>% dplyr::select(county:both_other_chronic_respiratory_diseases)%>%
ggcorr()
unique(data)
data %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr()
ggcorrplot(corr, sig.level=0.05, lab_size = 4.5, p.mat = NULL,
insig = c("pch", "blank"), pch = 1, pch.col = "black", pch.cex =1,
tl.cex = 14) +
theme(axis.text.x = element_text(margin=margin(-2,0,0,0)),  # Order: top, right, bottom, left
axis.text.y = element_text(margin=margin(0,-2,0,0))) +
geom_vline(xintercept=1:ncol(mtcars)-0.5, colour="white", size=2) +
geom_hline(yintercept=1:ncol(mtcars)-0.5, colour="white", size=2)
data %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr(geom= "circle" , nbreaks =5 )
ggcorr(nba[, 2:15], geom = "circle", nbreaks = 5, label= TRUE)
data %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr(geom= "circle" , nbreaks =5, label= TRUE)
data %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6, label= TRUE)
data[data$state == 'ID', ]
idaho <- data[data$state == 'ID', ]
View(idaho)
montana <- data[data$state == 'MT', ]
View(montana)
wyoming <- data[data$state == 'WY', ]
View(wyoming)
montana %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6, label= TRUE)
wyoming %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6, label= TRUE)
corr_simple(idaho)
install.packages("corrplot")
library(corrplot)
corr_simple(idaho)
corrplot(idaho)
corrplot(data_corr)
corplot(data_corr)
corrplot(data_corr)
library(corrplot)
corrplot(data_corr)
wyoming %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6, label= TRUE)
ggcorrplot(data)
library(ggplot2)
ggcorrplot(data)
??ggcorrplot
wyoming %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6, label= TRUE)
data %>% dplyr::select(lung_cancer_per_100000:both_other_chronic_respiratory_diseases)%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6, label= TRUE)
colnames(data) <- c('1','2','3','4','5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34')
data_temp <- colnames(data) <- c('1','2','3','4','5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34')
data_temp
View(data_temp)
names(data)<- c('1','2','3','4','5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34')
data <- read_csv("Cleaned Merged Data/darkorchid4_data.csv")
data <- clean_names(data)
names(data)
idaho <- data[data$state == 'ID', ]
View(idaho)
montana <- data[data$state == 'MT', ]
View(montana)
wyoming <- data[data$state == 'WY', ]
View(wyoming)
data_temp <- names(data)<- c('FIPS', 'county', 'state', '1','2','3','4','5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34')
data_temp
View(data_temp)
names(data)<- c('FIPS', 'county', 'state', '1','2','3','4','5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34')
data
View(data)
data %>% dplyr::select(1:34)%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6, label= TRUE)
data %>% dplyr::select('1':'34')%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6, label= TRUE)
data %>% dplyr::select('1':'34')%>%
ggcorr(geom= "circle" , nbreaks =5, min_size= 0, max_size= 6)
data %>% dplyr::select('1':'34')%>%
ggcorr()
data %>% dplyr::select('1':'34')%>%
ggcorr(geom= "circle")
data %>% dplyr::select('1':'34')%>%
ggcorr()
data %>% dplyr::select('1':'34')%>%
ggcorr()
data %>% dplyr::select('1':'34')%>%
ggcorr()
library(tidyverse)
library(tidycensus)
library(ggplot2)
library(ggmap)
library(geosphere)
library(sp)
library(rgdal)
library(rgeos)
library(maps)
library(GADMTools)
library(maptools)
library(countrycode)
library(usmap)
install.packages("ggpubr")
library(patchwork)
data("world.cities")
head(world.cities)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
Hathaway_data <- new_cleaned_data_excel_715
install.packages("ggpubr")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
data <- read_csv("Cleaned Merged Data/darkorchid4_data.csv")
library(tidyverse)
